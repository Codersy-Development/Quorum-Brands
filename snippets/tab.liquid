{%- liquid
  assign has_content = false
  assign debug_output = ''
  
  if content != blank and content != '' and content != nil
    assign debug_output = debug_output | append: 'Content exists. '
    
    assign stripped_content = content | strip_html | strip
    assign debug_output = debug_output | append: 'Stripped length: ' | append: stripped_content.size | append: '. '
    
    assign no_spaces = stripped_content | replace: ' ', '' | replace: '&nbsp;', '' | replace: '\n', '' | replace: '\r', '' | replace: '\t', ''
    assign debug_output = debug_output | append: 'No spaces length: ' | append: no_spaces.size | append: '. '
    
    if no_spaces != blank and no_spaces != '' and no_spaces.size > 0
      assign has_content = true
      assign debug_output = debug_output | append: 'HAS CONTENT. '
    else
      assign debug_output = debug_output | append: 'NO CONTENT. '
    endif
  else
    assign debug_output = 'Content is blank/empty/nil. '
  endif
-%}

{% comment %} Remove this debug section in production {% endcomment %}
<div style="background: #f0f0f0; padding: 10px; margin: 10px 0; font-size: 12px; border: 1px solid #ccc;">
  <strong>DEBUG:</strong> {{ debug_output }}<br>
  <strong>Original content:</strong> "{{ content }}"<br>
  <strong>Stripped content:</strong> "{{ content | strip_html | strip }}"<br>
  <strong>Will show tab:</strong> {{ has_content }}
</div>

{%- if has_content -%}
<div class="collapsibles-wrapper collapsibles-wrapper--border-bottom">
  <button type="button" class="label collapsible-trigger collapsible-trigger-btn collapsible-trigger-btn--borders collapsible--auto-height{%- if force_open %} is-open{%- endif -%}" aria-controls="Product-content-{{ id }}"{%- if force_open %} aria-expanded="true"{%- endif -%}>
    {{- title | strip -}}
    {%- render 'collapsible-icons' -%}
  </button>
  <div id="Product-content-{{ id }}" class="collapsible-content collapsible-content--all{%- if force_open %} is-open{%- endif -%}"{%- if force_open %} style="height: auto;"{%- endif -%}>
    <div class="collapsible-content__inner rte">
      {{- content -}}
    </div>
  </div>
</div>
{%- else -%}
<div style="background: #ffeeee; padding: 10px; margin: 10px 0; font-size: 12px; border: 1px solid #ffcccc;">
  <strong>TAB HIDDEN:</strong> No meaningful content detected.
</div>
{%- endif -%}